title:: 【Reading Highlights】见微知著，你真的搞懂 Google 的 Wide&Deep 模型了吗？
source:: https://zhuanlan.zhihu.com/p/142958834
tags:: [[简悦]] [[推荐系统]]  [[王喆]]  [[特征工程]]  [[推荐指数：四星]]   [[reading_highlights]]
date:: 20220530

- > FTRL with L1 非常注重模型的稀疏性。这也就是问题的答案，W&D 采用 L1 FTRL 是想让 Wide 部分变得更加稀疏。  ([🌐 摘要链接](https://zhuanlan.zhihu.com/p/142958834#js_content:~:text=FTRL%20with%20L1%20%E9%9D%9E%E5%B8%B8%E6%B3%A8%E9%87%8D%E6%A8%A1%E5%9E%8B%E7%9A%84%E7%A8%80%E7%96%8F%E6%80%A7%E3%80%82%E8%BF%99%E4%B9%9F%E5%B0%B1%E6%98%AF%E9%97%AE%E9%A2%98%E7%9A%84%E7%AD%94%E6%A1%88%EF%BC%8CW&D%20%E9%87%87%E7%94%A8%20L1%20FTRL%20%E6%98%AF%E6%83%B3%E8%AE%A9%20Wide%20%E9%83%A8%E5%88%86%E5%8F%98%E5%BE%97%E6%9B%B4%E5%8A%A0%E7%A8%80%E7%96%8F%E3%80%82))
	- 📝 L1 FTRL 让 Wide and Deep 的 Wide 侧更加稀疏！
- > L1 FTRL 会让 Wide 部分的大部分权重都为 0，我们准备特征的时候就不用准备那么多 0 权重的特征了，这大大压缩了模型权重，也压缩了特征向量的维度。  ([🌐 摘要链接](https://zhuanlan.zhihu.com/p/142958834#js_content:~:text=L1%20FTRL%20%E4%BC%9A%E8%AE%A9%20Wide%20%E9%83%A8%E5%88%86%E7%9A%84%E5%A4%A7%E9%83%A8%E5%88%86%E6%9D%83%E9%87%8D%E9%83%BD%E4%B8%BA%200%EF%BC%8C%E6%88%91%E4%BB%AC%E5%87%86%E5%A4%87%E7%89%B9%E5%BE%81%E7%9A%84%E6%97%B6%E5%80%99%E5%B0%B1%E4%B8%8D%E7%94%A8%E5%87%86%E5%A4%87%E9%82%A3%E4%B9%88%E5%A4%9A%200%20%E6%9D%83%E9%87%8D%E7%9A%84%E7%89%B9%E5%BE%81%E4%BA%86%EF%BC%8C%E8%BF%99%E5%A4%A7%E5%A4%A7%E5%8E%8B%E7%BC%A9%E4%BA%86%E6%A8%A1%E5%9E%8B%E6%9D%83%E9%87%8D%EF%BC%8C%E4%B9%9F%E5%8E%8B%E7%BC%A9%E4%BA%86%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F%E7%9A%84%E7%BB%B4%E5%BA%A6%E3%80%82))
- > 两个 id 类特征向量进行组合，在维度爆炸的同时，会让原本已经非常稀疏的 multihot 特征向量，变得更加稀疏。正因如此，wide 部分的权重数量其实是海量的。为了不把数量如此之巨的权重都搬到线上进行 model serving，采用 FTRL 过滤掉哪些稀疏特征无疑是非常好的工程经验。 [[特征工程]]   ([🌐 摘要链接](https://zhuanlan.zhihu.com/p/142958834#js_content:~:text=%E4%B8%A4%E4%B8%AA%20id%20%E7%B1%BB%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F%E8%BF%9B%E8%A1%8C%E7%BB%84%E5%90%88%EF%BC%8C%E5%9C%A8%E7%BB%B4%E5%BA%A6%E7%88%86%E7%82%B8%E7%9A%84%E5%90%8C%E6%97%B6%EF%BC%8C%E4%BC%9A%E8%AE%A9%E5%8E%9F%E6%9C%AC%E5%B7%B2%E7%BB%8F%E9%9D%9E%E5%B8%B8%E7%A8%80%E7%96%8F%E7%9A%84%20multihot%20%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F%EF%BC%8C%E5%8F%98%E5%BE%97%E6%9B%B4%E5%8A%A0%E7%A8%80%E7%96%8F%E3%80%82%E6%AD%A3%E5%9B%A0%E5%A6%82%E6%AD%A4%EF%BC%8Cwide%20%E9%83%A8%E5%88%86%E7%9A%84%E6%9D%83%E9%87%8D%E6%95%B0%E9%87%8F%E5%85%B6%E5%AE%9E%E6%98%AF%E6%B5%B7%E9%87%8F%E7%9A%84%E3%80%82%E4%B8%BA%E4%BA%86%E4%B8%8D%E6%8A%8A%E6%95%B0%E9%87%8F%E5%A6%82%E6%AD%A4%E4%B9%8B%E5%B7%A8%E7%9A%84%E6%9D%83%E9%87%8D%E9%83%BD%E6%90%AC%E5%88%B0%E7%BA%BF%E4%B8%8A%E8%BF%9B%E8%A1%8C%20model%20serving%EF%BC%8C%E9%87%87%E7%94%A8%20FTRL%20%E8%BF%87%E6%BB%A4%E6%8E%89%E5%93%AA%E4%BA%9B%E7%A8%80%E7%96%8F%E7%89%B9%E5%BE%81%E6%97%A0%E7%96%91%E6%98%AF%E9%9D%9E%E5%B8%B8%E5%A5%BD%E7%9A%84%E5%B7%A5%E7%A8%8B%E7%BB%8F%E9%AA%8C%E3%80%82))
	- 📝 工程经验：使用 L1 FTRL 过滤稀疏特征
- > Deep 部分的输入，要么是 Age，#App Installs 这些数值类特征，要么是已经降维并稠密化的 Embedding 向量，工程师们不会也不敢把过度稀疏的特征向量直接输入到 Deep 网络中。所以 Deep 部分不存在严重的特征稀疏问题，自然可以使用精度更好，更适用于深度学习训练的 AdaGrad 去训练。  ([🌐 摘要链接](https://zhuanlan.zhihu.com/p/142958834#js_content:~:text=Deep%20%E9%83%A8%E5%88%86%E7%9A%84%E8%BE%93%E5%85%A5%EF%BC%8C%E8%A6%81%E4%B9%88%E6%98%AF%20Age%EF%BC%8C#App%20Installs%20%E8%BF%99%E4%BA%9B%E6%95%B0%E5%80%BC%E7%B1%BB%E7%89%B9%E5%BE%81%EF%BC%8C%E8%A6%81%E4%B9%88%E6%98%AF%E5%B7%B2%E7%BB%8F%E9%99%8D%E7%BB%B4%E5%B9%B6%E7%A8%A0%E5%AF%86%E5%8C%96%E7%9A%84%20Embedding%20%E5%90%91%E9%87%8F%EF%BC%8C%E5%B7%A5%E7%A8%8B%E5%B8%88%E4%BB%AC%E4%B8%8D%E4%BC%9A%E4%B9%9F%E4%B8%8D%E6%95%A2%E6%8A%8A%E8%BF%87%E5%BA%A6%E7%A8%80%E7%96%8F%E7%9A%84%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F%E7%9B%B4%E6%8E%A5%E8%BE%93%E5%85%A5%E5%88%B0%20Deep%20%E7%BD%91%E7%BB%9C%E4%B8%AD%E3%80%82%E6%89%80%E4%BB%A5%20Deep%20%E9%83%A8%E5%88%86%E4%B8%8D%E5%AD%98%E5%9C%A8%E4%B8%A5%E9%87%8D%E7%9A%84%E7%89%B9%E5%BE%81%E7%A8%80%E7%96%8F%E9%97%AE%E9%A2%98%EF%BC%8C%E8%87%AA%E7%84%B6%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E7%B2%BE%E5%BA%A6%E6%9B%B4%E5%A5%BD%EF%BC%8C%E6%9B%B4%E9%80%82%E7%94%A8%E4%BA%8E%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E8%AE%AD%E7%BB%83%E7%9A%84%20AdaGrad%20%E5%8E%BB%E8%AE%AD%E7%BB%83%E3%80%82))